---
title: "Learning to work with R packages"
subtitle: ""
author: "David Schoch"
footer: "EMCR Workshop 2023 {{< fa brands r-project >}}"
institute: "GESIS - Leibniz Institute for the Social Sciences"
shortcodes:
  - misc.lua
format: 
  revealjs: 
    menu: true
    progress: false
    theme: "schochastics.scss"
    slide-number: c/t
    show-slide-number: all
    code-line-numbers: false
execute: 
  echo: true
---

## My R universe

:::{.center-x}
![](img/hex_bg.png){width=700}
:::

## Why R?

<br>

::::{.columns}

:::{.column width="32%"}
:::{.frame-box .center-x}
{{< fa door-open size=2x >}}  
open source
:::
:::
:::{.column width="32%"}
:::{.frame-box .center-x}
{{< fa brands apple size=2x >}} {{< fa brands ubuntu size=2x >}} {{< fa brands windows size=2x >}}  
cross-platform
:::
:::
:::{.column width="32%"}
:::{.frame-box .center-x}
{{< fa box-open size=2x >}}  
CRAN
:::
:::
::::

::::{.columns}
:::{.column width="32%"}
:::{.frame-box .center-x}
{{< fa repeat size=2x >}}  
reproducibility
:::
:::

:::{.column width="32%"}
:::{.frame-box .center-x}
{{< fa chart-pie size=2x >}}  
more than SNA
:::
:::

:::{.column width="32%"}
:::{.frame-box .center-x}
{{< fa comments size=2x >}}  
community  
:::
:::
::::

# Using R packages

## R Ecosystem for networks

```{r}
#| label: cranet
#| echo: false
library(ggraph)
g <- readRDS("dependnet.RDS")
ggraph(g, "stress") +
    geom_edge_link0(
        edge_color = "grey66", edge_width = 0.3,
        arrow = arrow(
            angle = 15, length = unit(0.15, "inches"),
            ends = "last", type = "closed"
        )
    ) +
    geom_node_point(shape = 21, aes(fill = dep, size = seed)) +
    scale_fill_brewer(type = "qual", name = "") +
    scale_size_manual(values = c(2, 5), guide = "none") +
    guides(fill = guide_legend(override.aes = list(size = 5))) +
    theme_void() +
    theme(legend.position = "bottom") +
    coord_equal(clip = "off")

```

## Which package to choose?

<br>

use `igraph` if

- you need speed (large networks)
- you need to use other SNA packages

:::{.fragment}
use `network`/`sna` if

- you need to do modeling (e.g. ERGMs and RSIENA)
:::

:::{.fragment}
**does not make a difference in most cases, never load them both!**
:::

## Small overview

- Analyze "standard" networks with {{< CRAN igraph >}}

- Analyze two-mode network projections with {{< CRAN backbone >}}

- Analyze signed networks with {{< CRAN signnet >}}

- Missing something? try {{< CRAN netUtils >}}

- Need toy data? use [networkdata](https://github.com/schochastics/networkdata)

- Need a GUI to analyze networks in RStudio? try {{< CRAN snahelper >}}

- "I like my networks tidy" {{< CRAN tidygraph >}}

- "Is there a ggplot2 for networks?" {{< CRAN ggraph >}}

- ...

## Finding the right package

You donâ€™t need to write everything yourself from scratch. There are thousands of R packages that people have written to solve problems. 

- [CRAN taskviews](https://cran.r-project.org/web/views/)  (available since 2005, [redesigned in 2021](https://arxiv.org/abs/2305.17573))

- [r-universe.dev](https://r-universe.dev/) (R package dashboards)

- [r-bloggers.com](https://www.r-bloggers.com/) (blog aggregator)

- social media

##

![](img/runiverse.png)

## Finding the right package

You donâ€™t need to write everything yourself from scratch. There are thousands of R packages that people have written to solve problems. 

- [CRAN taskviews](https://cran.r-project.org/web/views/)  (available since 2005, [redesigned in 2021](https://arxiv.org/abs/2305.17573))

- [r-universe.dev](https://r-universe.dev/) (R package dashboards)

- [r-bloggers.com](https://www.r-bloggers.com/) (blog aggregator)

- social media

## Help for R packages

<br>

Help for a function
```r
?function_name
help(function_name)
??function_name
```

. . .

Help for the package

```r
browseVignettes(package = "name-of-package")
vignette("name-of-vignette")
```

. . .

{{< CRAN pkgdown >}} website

##

::: {.r-fit-text}
CITE  
PACKAGES!
:::

## How to cite R packages

```{r}
#| label: cite-example
citation("graphlayouts")
```

or use {{< CRAN grateful >}}


## Resources

<br>

- [rOpenSci](https://ropensci.org/)

- [R for the rest of us](https://rfortherestofus.com/)

- [R4DS online learning community](https://rfordatasci.com/) (e.g. [TidyTuesday](https://github.com/rfordatascience/tidytuesday))

- [Help to get help](https://masalmon.eu/2018/07/22/wheretogethelp/)

- [R for Data Science](https://r4ds.had.co.nz/)

- [Advanced R](https://adv-r.hadley.nz/)

- [How to get good with R](https://www.njtierney.com/post/2023/11/10/how-to-get-good-with-r/)

- [What They Forgot to Teach You About R](https://rstats.wtf/)

# Developing R packages

## Why develop an R package?

<br>

Easiest way to share code and data with

- yourself to organize your own utility functions

- your collaborators as a package for your team

- everyone! your package could help other R users without being a general purpose tool

:::{.aside}
credits to [MaÃ«lle Salmon](https://masalmon.eu/2023/11/09/r-package-development-teaching-intro/) for the content
:::

## Who can learn about package development?

<br>

Ask yourself: 

- Can you open R or RStudio?

- Can you install a package?

- Have you ever written a function in R?

- Could you learn how to write a function in R?

. . . 

**Congrats, you can develop an R package**

:::{.aside}
credits to [Susan Johnston](https://raw.githubusercontent.com/susjoh/fibonacci/master/Writing_R_Packages_from_Scratch_v2_annotated.pdf) for the content
:::

## My first R package

![](https://github.com/schochastics/netrankr/blob/main/man/figures/logo.png?raw=true){.absolute top=0 right=10 width=125}

My Phd thesis produced a lot of R code 

:::{.center-x}
![](img/phd_folder.png){width=650}
:::

## My first R package

![](https://github.com/schochastics/netrankr/blob/main/man/figures/logo.png?raw=true){.absolute top=0 right=10 width=125}

- My Phd thesis also produced a lot of new methods 

- To make it reusable, I decided to create an R package 

:::{.center-x}
![](img/phd_git.png)
:::

- submitted to CRAN almost a year later ðŸ˜±

. . .

- rtoot (2022) from first line of code to CRAN in 5 days ðŸš€ðŸš€ðŸš€


## Your first R package

<br>

> *It doesnâ€™t matter if your first version isnâ€™t perfect as long as the next version is better.*  
Hadley Wickham/Jenny Brian

. . . 

A package is just a folder with rules where a lot of boring things can be automated with {{< CRAN usethis >}} and {{< CRAN devtools >}}.

```r
library(usethis)
create_package("path/to/mypkg")
```
##

:::{.center-x}
![](img/automagic.jpg)
:::

## Publish your first Package

<br>

Your first package **does not** need to go to CRAN but can comfortably live on [GitHub](https://happygitwithr.com/).

```r
#install.packages("remotes")
remotes::install_github("username/pkgname")
```

<br>

. . .

add your account to the [r-universe](https://r-universe.dev/search/) following [these steps](https://github.com/r-universe-org/help#how-to-setup-your-personal-universe)

. . .

Preparing for CRAN can be tricky at first, but there [is help](https://github.com/ThinkR-open/prepare-for-cran)



## Some more Resources

<br>

- [R Packages (2e)](https://r-pkgs.org/)

- [List of resources by MaÃ«lle Salmon](https://rpkgdev-mechanics.netlify.app/resources/)

- [Submitting to CRAN](https://github.com/ThinkR-open/prepare-for-cran)

- [Help for r-universe](https://github.com/r-universe-org/help)

##

::: {.r-fit-text}
An R package is   
never done
:::

##

:::{.center-x}
![](img/mad_scientist.webp){width=600}
:::

:::{.text04}
Created with DALL E
:::


##

:::{.center-x}
![](img/bored_dev.webp){width=600}
:::

:::{.text04}
Created with DALL E
:::

## Maintaining R packages

:::{.center-x}
![](img/bus-rpkg.jpg){width=700}
:::

## Maintaining R packages

<br>

you may eventually start reading about "software design"

- [Working in Public: The Making and Maintenance of Open Source Software](https://www.amazon.de/dp/0578675862?psc=1&ref=ppx_yo2ov_dt_b_product_details)

- [A Philosophy of Software Design](https://www.amazon.de/dp/173210221X?psc=1&ref=ppx_yo2ov_dt_b_product_details)

- [Pragmatic Programmer, The: Your journey to mastery](https://www.amazon.de/dp/0135957052?psc=1&ref=ppx_yo2ov_dt_b_product_details)

- ...

## Appreciate developers

:::{.center-x}
![](img/collapse.jpg){height=600}
:::

##

:::{.center-x}
![](img/open-source-developers.jpg){width=800}
:::

## Tips

<br>

- Do not respond to all issues immediately

- Work in intervalls

- People will be rude

- Most feedback will be negative

- You will not know who uses your package

:::{.center-x}
**Try to keep your sanity**
:::
